---
title: "data"
author: '2712756'
date: "2023-08-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown


```{r }
library(stats)
library(lme4)
library(tidyverse)
library(ggplot2)
library(broom)
library(knitr)
library(gridExtra)
```

```{r}
# Read excels
df <- read_csv("fMRI_Data.csv")
```

```{r}
# Subset the data for encoding stage
encoding_CA3 <- df$CA3[df$Enc_or_Ret == 1]
encoding_DG <- df$DG[df$Enc_or_Ret == 1]

# Perform the paired t-test for CA3 and DG in encoding
enc_paired_t_test <- t.test(encoding_CA3, encoding_DG, paired = TRUE)

# Display the t-test results
print(enc_paired_t_test)
# Tidy the t-test results using broom
enc_paired_t_test_results <- tidy(enc_paired_t_test)

# Create a table from the t-test results
table_output <- kable(enc_paired_t_test_results, caption = "Paired t-test Results for CA3 and DG in Encoding")

# Print the table
print(table_output)
```

```{r}
# Subset the data for retrieval stage
retrieval_CA3 <- df$CA3[df$Enc_or_Ret == 2]
retrieval_DG <- df$DG[df$Enc_or_Ret == 2]

# Perform the paired t-test for CA3 and DG in retrieval
ret_paired_t_test <- t.test(retrieval_CA3, retrieval_DG, paired = TRUE)

# Display the t-test results
print(ret_paired_t_test)
```

```{r}
# Perform the t-test for DG-CA3 in encoding and retrieval
df$diff<-df$DG-df$CA3
t.test(df$diff[df$Enc_or_Ret==1],df$diff[df$Enc_or_Ret==2])
```

```{r}
# Perform the t-test for DG in encoding and retrieval
t.test(df$DG[df$Enc_or_Ret==1],df$DG[df$Enc_or_Ret==2])
```

```{r}
# Perform the t-test for CA3 in encoding and retrieval
t.test(df$CA3[df$Enc_or_Ret==1],df$CA3[df$Enc_or_Ret==2])
```

## Including Plots

```{r}
# Calculate the mean activations for CA3 and DG during encoding and retrieval
table_df <- df %>%
  group_by(Enc_or_Ret) %>%
  summarize(Mean_CA3 = mean(CA3),
            Mean_DG = mean(DG))
table_df
```


```{r}
# Define the custom colors for CA3 and DG bars
ca3_color <- "#1f78b4"  # Blue
dg_color <- "#33a02c"   # Green

# Create the bar plots for CA3 to visualize the differences in activations 
CA3_bar_plot <- ggplot(table_df, aes(x = factor(Enc_or_Ret), y = Mean_CA3, fill = "CA3")) +
  geom_bar(stat = "identity", position = "dodge", width = 0.5, color = "black") +  # Add black borders to bars
  geom_text(aes(label = round(Mean_CA3, 2)), position = position_dodge(width = 0.5), vjust = -0.5) +
  labs(x = "Encoding or Retrieval", y = "Mean CA3 Activation") +
  scale_x_discrete(labels = c("Encoding", "Retrieval")) +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title = element_text(size = 12, face = "bold"),
        axis.text = element_text(size = 10),
        plot.title = element_text(size = 14, face = "bold"),
        panel.background = element_rect(fill = "white"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_rect(color = "black", fill = NA)) +
  scale_fill_manual(values = ca3_color) +
  coord_cartesian(ylim = c(0, max(table_df$Mean_CA3) * 3.1))
CA3_bar_plot 
```
  

```{r}
# Create the bar plots for DG to visualize the differences in activations 
DG_bar_plot <- ggplot(table_df, aes(x = factor(Enc_or_Ret), y = Mean_DG, fill = "DG")) +
  geom_bar(stat = "identity", position = "dodge", width = 0.5, color = "black") +  # Add black borders to bars
  geom_text(aes(label = round(Mean_DG, 2)), position = position_dodge(width = 0.5), vjust = -0.5) +
  labs(x = "Encoding or Retrieval", y = "Mean DG Activation") +
  scale_x_discrete(labels = c("Encoding", "Retrieval")) +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title = element_text(size = 12, face = "bold"),
        axis.text = element_text(size = 10),
        plot.title = element_text(size = 14, face = "bold"),
        panel.background = element_rect(fill = "white"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_rect(color = "black", fill = NA)) +
  scale_fill_manual(values = dg_color)+
  coord_cartesian(ylim = c(0, max(table_df$Mean_DG) * 4.1)) 
DG_bar_plot
```

```{r}
# Display both bar plots side by side with custom colors and appearance
grid.arrange(DG_bar_plot,CA3_bar_plot , ncol = 2)
```


